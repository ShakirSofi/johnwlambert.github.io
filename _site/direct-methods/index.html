<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Direct Methods for Linear System Solving</title>
  <meta name="description" content="LU, Cholesky, QR">
   <link rel="stylesheet" href="/css/main.css">


  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://johnwlambert.github.io/direct-methods/">

  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/assets/css/academicons.css"/>


  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">

    <a class="site-title" href="/">John Lambert</a>

    <nav class="site-nav">
      <span class="menu-icon">
        <svg viewBox="0 0 18 15" width="18px" height="15px">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </span>

      <div class="trigger">
        
          
          
          <a class="page-link" href="/collaborators/">Collaborators</a>
          
          
        
          
          
          
        
          
          
          <a class="page-link" href="/publications/">Publications</a>
          
          
        
          
          
          <a class="page-link" href="/teaching/">Teaching</a>
          
          
        
          
          
          
        
          
          
          
        
      </div>
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1>Direct Methods for Linear System Solving</h1>
    <p class="meta">Feb 12, 2019</p>
  </header>

  <article class="post-content">
  <p>Table of Contents:</p>
<ul>
  <li><a href="#sfmpipeline">Back Substitution</a></li>
  <li><a href="#costfunctions">LU Factorization</a></li>
  <li><a href="#bundleadjustment">Cholesky Factorization</a></li>
</ul>

<p><a name="sfmpipeline"></a></p>

<h2 id="back-substitution-for-triangular-matrices">Back Substitution for Triangular Matrices</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">back_substitution</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
	<span class="s">""" """</span>
	<span class="n">n</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
	<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
	<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
			<span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
		<span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">]</span>

	<span class="k">return</span> <span class="n">x</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">back_substitution_demo</span><span class="p">():</span>
	<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
	<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
	<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
	<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
	<span class="n">b</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

	<span class="n">x_est</span> <span class="o">=</span> <span class="n">back_substitution</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="lu-decomposition">LU Decomposition</h2>
<p>In the LU Decomposition/Factorization, we seek to find two matrices <script type="math/tex">L,U</script> such that <script type="math/tex">A = L * U</script>, and where <script type="math/tex">L</script> is unit lower triangular (1’s along the diagonal), and where <script type="math/tex">U</script> is upper triangular.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">LU_demo</span><span class="p">():</span>
	<span class="s">""" """</span>
	<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
	<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>

	<span class="n">L</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">LU</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</code></pre></div></div>

<script type="math/tex; mode=display">% <![CDATA[
A =  \begin{bmatrix}  7& 5& 4& 6& 7& 1& 4& 1& 1& 2 \\
            9& 1& 2& 2& 4& 8& 9& 5& 4& 5 \\
            6& 5& 6& 2& 1& 5& 6& 2& 7& 4 \\
            6& 8& 3& 6& 2& 5& 8& 4& 7& 3 \\
            6& 7& 6& 7& 8& 4& 8& 7& 8& 8 \\
            4& 4& 4& 4& 5& 2& 1& 7& 4& 2 \\
            3& 7& 4& 9& 7& 5& 3& 8& 2& 3 \\
            7& 1& 8& 8& 7& 6& 4& 8& 5& 8 \\
            4& 5& 3& 5& 1& 4& 6& 4& 3& 3 \\
            3& 3& 3& 3& 7& 4& 5& 2& 5& 9 \end{bmatrix}, M_0 = \begin{bmatrix} 1.     &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                -1.285 &  1.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                -0.857 &  0.        &  1.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                -0.857 &  0.        &  0.        &  1.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                -0.857 &  0.        &  0.        &  0.        &  1.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                -0.571 &  0.        &  0.        &  0.        &  0.        & 1.        &  0.        &  0.        &  0.        &  0.        \\
                -0.428 &  0.        &  0.        &  0.        &  0.        & 0.        &  1.        &  0.        &  0.        &  0.        \\
                -1.    &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  1.        &  0.        &  0.        \\
                -0.571 &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  1.        &  0.        \\
                -0.428 &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  1.       \\
\end{bmatrix} %]]></script>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">LU</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
	<span class="s">""" 
	Alternatively, we could compute multipliers,
	update the A matrix entries that change 
	(lower square block), and then store the
	multipliers in the empty, lower triangular part of A.
	"""</span>
	<span class="n">n</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
	<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
	<span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
	<span class="c"># loop over the columns of U</span>
	<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
		<span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
		<span class="c"># compute multipliers for each row under the diagonal</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
			<span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">U</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">]</span>
		<span class="c"># must update the matrix to compute</span>
		<span class="c"># multipliers for next column</span>
		<span class="n">pdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
		<span class="n">U</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>

	<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
	<span class="c"># left-multiply higher M matrices</span>
	<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
		<span class="n">L</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
	<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">L</span><span class="p">,</span><span class="n">U</span>
</code></pre></div></div>

<p>Suppose we wish to see how <script type="math/tex">A</script> changes when <script type="math/tex">M_0</script> is applied: the zero’th column is now upper triangular.</p>

<p><script type="math/tex">% <![CDATA[
M_0 A = \begin{bmatrix} 7. &  5. &  4. &  6. &  7. &  1. &  4. &  1. &  1. &  2.  \\
			 0. & -5.4& -3.1& -5.7& -5. &  6.7&  3.9&  3.7&  2.7&  2.4 \\
			 0. &  0.7&  2.6& -3.1& -5. &  4.1&  2.6&  1.1&  6.1&  2.3 \\
			 0. &  3.7& -0.4&  0.9& -4. &  4.1&  4.6&  3.1&  6.1&  1.3 \\
			 0. &  2.7&  2.6&  1.9&  2. &  3.1&  4.6&  6.1&  7.1&  6.3 \\
			 0. &  1.1&  1.7&  0.6&  1. &  1.4& -1.3&  6.4&  3.4&  0.9 \\
			 0. &  4.9&  2.3&  6.4&  4. &  4.6&  1.3&  7.6&  1.6&  2.1 \\
			 0. & -4. &  4. &  2. &  0. &  5. &  0. &  7. &  4. &  6.  \\
			 0. &  2.1&  0.7&  1.6& -3. &  3.4&  3.7&  3.4&  2.4&  1.9 \\
			 0. &  0.9&  1.3&  0.4&  4. &  3.6&  3.3&  1.6&  4.6&  8.1 \end{bmatrix}, A = \begin{bmatrix}  7& 5& 4& 6& 7& 1& 4& 1& 1& 2 \\
            9& 1& 2& 2& 4& 8& 9& 5& 4& 5 \\
            6& 5& 6& 2& 1& 5& 6& 2& 7& 4 \\
            6& 8& 3& 6& 2& 5& 8& 4& 7& 3 \\
            6& 7& 6& 7& 8& 4& 8& 7& 8& 8 \\
            4& 4& 4& 4& 5& 2& 1& 7& 4& 2 \\
            3& 7& 4& 9& 7& 5& 3& 8& 2& 3 \\
            7& 1& 8& 8& 7& 6& 4& 8& 5& 8 \\
            4& 5& 3& 5& 1& 4& 6& 4& 3& 3 \\
            3& 3& 3& 3& 7& 4& 5& 2& 5& 9 \end{bmatrix} %]]></script>
I’m actually rounding the entries above, i.e. showing the output of:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>A fact that makes computing the inverses of these elementary GE matrices trivial: simply negate the spike entries below the diagonal.</p>

<p><script type="math/tex">% <![CDATA[
M_0 = \begin{bmatrix} 1.     &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                -1.285 &  1.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                -0.857 &  0.        &  1.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                -0.857 &  0.        &  0.        &  1.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                -0.857 &  0.        &  0.        &  0.        &  1.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                -0.571 &  0.        &  0.        &  0.        &  0.        & 1.        &  0.        &  0.        &  0.        &  0.        \\
                -0.428 &  0.        &  0.        &  0.        &  0.        & 0.        &  1.        &  0.        &  0.        &  0.        \\
                -1.    &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  1.        &  0.        &  0.        \\
                -0.571 &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  1.        &  0.        \\
                -0.428 &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  1.       \\
\end{bmatrix},  M_0^{-1} = \begin{bmatrix} 1.     &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                1.285 &  1.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                0.857 &  0.        &  1.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                0.857 &  0.        &  0.        &  1.        &  0.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                0.857 &  0.        &  0.        &  0.        &  1.        & 0.        &  0.        &  0.        &  0.        &  0.        \\
                0.571 &  0.        &  0.        &  0.        &  0.        & 1.        &  0.        &  0.        &  0.        &  0.        \\
                0.428 &  0.        &  0.        &  0.        &  0.        & 0.        &  1.        &  0.        &  0.        &  0.        \\
                1.    &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  1.        &  0.        &  0.        \\
                0.571 &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  1.        &  0.        \\
                0.428 &  0.        &  0.        &  0.        &  0.        & 0.        &  0.        &  0.        &  0.        &  1.       \\
\end{bmatrix} %]]></script>
Indeed, <script type="math/tex">L</script> is lower-triangular and <script type="math/tex">U</script> is upper-triangular, as desired:</p>

<script type="math/tex; mode=display">% <![CDATA[
L = \begin{bmatrix}   1.&    0.&   0.&    0.&   0.&    0.&    0.&    0.&   0. & 0. \\
    1.&    1.&    0.&   0.&    0.&    0.&    0.&    0.&   0.& 0. \\
    1.&   0.&    1.&   0.&   0.&   0.&    0.&    0.&    0.& 0. \\
    1.&   -1.&   -1.&    1.&   0.&    0.&   0.&   0.&   0.& 0. \\
    1.&   0.&    0.&   0.&    1.&   0.&    0.&   0.&    0. & 0. \\
    1.&   0.&    0.&   0.&    1.&    1.&    0.&    0.&    0.& 0. \\
    0.&   -1.&   -0.&   0.&   -4.&  -69.&    1.&   0.&   0. & 0. \\
    1.&    1.&    3.&   -2.&  -19.& -249.&    4.&    1.&   0. & 0. \\
    1.&   0.&   0.&    0.&   -5.&  -67.&    1.&    0.&    1.& 0. \\
    0.&   0.&    0.&   -0.&    6.&   53.&   -1.&   0.&   -1.& 1. \end{bmatrix} , U =  \begin{bmatrix}  7. &    5. &    4. &    6. &    7. &    1. &    4. &    1. &  1. &    2.  \\
   0. &   -5.4&   -3.1&   -5.7&   -5. &    6.7&    3.9&    3.7&  2.7&    2.4 \\
   0. &    0. &    2.2&   -3.9&   -5.7&    5. &    3.1&    1.6&   6.5&    2.6 \\
   0. &    0. &    0. &   -7.7&  -14.2&   14.7&   10.9&    7.6&   15.8&    6.1 \\
   0. &    0. &    0. &    0. &    0.6&    5.7&    6.2&    8. &  7.1&    6.9 \\
   0. &    0. &    0. &    0. &    0. &   -0.5&   -3.8&    3. &  -0.7&   -2.9 \\
   0. &    0. &    0. &    0. &    0. &    0. & -230.1&  247.9& -15.8& -169.  \\
   0. &    0. &    0. &    0. &    0. &    0. &    0. &   33.3& 27.7&    8.8 \\
   0. &    0. &    0. &    0. &    0. &    0. &    0. &    0. & -3.7&   -0.8 \\
   0. &    0. &    0. &    0. &    0. &    0. &    0. &    0. & 0. &    3.   \end{bmatrix} %]]></script>

<p>There is a very small amount of numerical error introduced in the process:</p>

<script type="math/tex; mode=display">\sum\limits_{i,j} (A - LU) = 2.80 \times 10^{-12}</script>

<h2 id="cholesky">Cholesky</h2>

<p>Suppose we wish to find an LU decomposition for a special type of matrix – one that is symmetric positive definite. In a <script type="math/tex">4 \times 4</script> version, we would see</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{bmatrix} A_{11} & A_{12} & A_{13} & A_{14} \\ A_{21} & A_{22} & A_{23} & A_{24} \\ A_{31} & A_{32} & A_{33} & A_{34} \\ A_{41} & A_{42} & A_{43} & A_{44} \end{bmatrix} = \begin{bmatrix} g_{11} & 0 & 0 & 0 \\ g_{21} & g_{22} & 0 & 0 \\ g_{31} & g_{32} & g_{33} & g_{34} \\ g_{41} & g_{42} & g_{43} & g_{44} \end{bmatrix} \begin{bmatrix} g_{11} & g_{21} & g_{31} & g_{41} \\ 0 & g_{22} & g_{32} & g_{42} \\ 0 & 0 & g_{33} & g_{43} \\ 0 & 0 & 0 & g_{44} \end{bmatrix} %]]></script>

<p>This gives us a set of <script type="math/tex">4^2=16</script> equations. Note that the equations we obtain from the bottom triangle of the matrix <script type="math/tex">A</script>, are identical to the equations we obtain from the upper triangle of <script type="math/tex">A</script> (since <script type="math/tex">A</script> is symmetric). For simplicity, we will work with the equations from the bottom triangle of <script type="math/tex">A</script>.</p>

<p>When we solve the constraints, we note (with one-indexed matrices), we have the following definitions for each term:</p>

<script type="math/tex; mode=display">g_{ij} = \frac{a_{ij} - \sum\limits_{k=1}^{j-1} g_{ik}g_{jk} }{g_{jj}}</script>

<p>When <script type="math/tex">j=i</script>, <script type="math/tex">a_{jj} = g_{jj} g_{jj} + \sum\limits_{k=1}^{j-1}g_{jk}^2</script>, implying</p>

<script type="math/tex; mode=display">g_{jj} = \sqrt{a_{jj} - \sum\limits_{k=1}^{j-1}g_{jk}^2}</script>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">Cholesky</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="s">""" 
    Only operate on bottom triangle of the matrix A,
    since A is symmetric (get same constraints
    from upper and lower triangle of A).
    """</span>
    <span class="n">n</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>

    <span class="c"># populate lower triangular part</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">k_sum</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="n">i</span><span class="p">:</span> <span class="c"># diagonal element</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
                    <span class="n">k_sum</span> <span class="o">+=</span> <span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">G</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">k_sum</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
                    <span class="n">k_sum</span> <span class="o">+=</span> <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">G</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span>
                <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">k_sum</span><span class="p">)</span><span class="o">/</span><span class="n">G</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">G</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">Cholesky_demo</span><span class="p">():</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="c"># generate a random n x n matrix</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

    <span class="c"># construct a symmetric matrix using either</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="c">#A = A.dot(A.T)</span>

    <span class="c"># make symmetric diagonally dominant matrix</span>
    <span class="n">A</span> <span class="o">+=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">w</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">Cholesky</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

    <span class="k">assert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">A</span><span class="p">),</span><span class="n">G</span><span class="p">))</span>
    <span class="k">assert</span><span class="p">(</span> <span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span> <span class="p">)</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1e-10</span> <span class="p">)</span>
</code></pre></div></div>


  </article>

  <!-- mathjax -->
  
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  
  <!-- disqus comments -->
<!--   -->
  
</div>
      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <!-- <h2 class="footer-heading">John Lambert</h2> -->

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              John Lambert
            
          </li>
          
          <li><a href="mailto:johnlambert [at] gatech.edu">johnlambert [at] gatech.edu</a></li>
          
          
       </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
         
          <li>
              <a href="https://scholar.google.com/citations?user=6GhZedEAAAAJ">
                <i class="ai ai-google-scholar ai"></i> Google Scholar
              </a>
          </li>
          
          
          
          <li>
              <a href="https://linkedin.com/in/johnwlambert">
                <i class="fa fa-linkedin fa"></i> LinkedIn
              </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
         <ul class="social-media-list">
          <li>
        <a>Ph.D. Candidate in Computer Vision.
</a>
         </li>
          <li>
        Website Design by <a href="http://www.niebles.net/">Juan Carlos Niebles, Ph.D.</a>
        </li>
         </ul>
      </div>
    </div>

  </div>

</footer>

    

  </body>

</html>
